

Question4. 대량의 공격성 접속문제로 서비스가 중단되는 상황이 발생될때, 서비스가 중단되는 원인 확인 및 해결방법에 대해 작성하시오
(서비스 구성은 : linux, nginx, php-fpm, mysql로 구성되어있다고 가정함)


1. 서비스 중단 원인 확인방법

    1) 접속에 대한 문제를 확인하려면 웹서버인 nginx의 로그가 가장 중요하다고 생각합니다.
    어떤 상황이 생길지 모르므로 평소에 미리 대비하여 로그포맷이나 기록위치 등을 잘 설정해두어야 합니다.
    nginx error log와 access log를 통해 언제, 어떤 에러가 발생하고 있는지 어떤 접속들이 발생하고 있는지를 통해 원인을 파악합니다.

    2) /var/log/messages 등 linux 로그 확인을 통해 서버로 들어온 다른 해킹시도나, 비정상적인 종료 등 nginx 및 기타 프로그램들의 작동에 대한 로그 기록을 찾아봅니다.

    3) /var/log/php-fpm/ 내에 존재하는 php-fpm 관련 로그들을 확인합니다.


2. 해결방법

    1) nginx에서는 자체적으로 시간당 request 개수를 제한하는 요청 비율 제한(limit_req), 단일 클라이언트 ip주소로 열 수 있는 연결수 제한(limit_con),
    시간을 끄는 느린 연결에 대한 time out 처리, ip주소 화이트리스트/블랙리스트 등의 기능을 제공하고 있으므로 최대한 활용해야 합니다.

    2) 그렇지만 이러한 기능들에도 불구하고 nginx만으로 공격을 예방하고 방어하는 데에는 한계가 있고,
    좀 더 강력한 방어를 위해서는 고성능 방화벽을 함께 운영하는 것이 최선이라고 생각합니다.